---
layout: default
title: Creating launch files
parent: Arquivos de launch
nav_order: 2
---

# Creating launch files
{: .no_toc }

## Sumário
{: .no_toc .text-delta }

1. TOC
{:toc}
---

Having seen how launch files can be used, we’re ready now to think about how to create
them for ourselves.

### Where to place launch files

As with all other ROS files, each launch file should be associated with a particular package.
The usual naming scheme is to give launch files names ending with `.launch.` The simplest
place to store launch files is directly in the package directory. When looking for launch
files, `roslaunch` will also search subdirectories of each package directory. Some packages,
including many of the core ROS packages, utilize this feature by organizing launch files
into a subdirectory of their own, usually called `launch`.

### Basic ingredients

The simplest launch files consist of a root element containing several `node` elements.

#### Inserting the root element

Launch files are XML documents, and every XML document
must have exactly one **root element**. For ROS launch files, the root element is defined by a
pair of `launch` tags:

```
<launch>
...
</launch>
```

All of the other elements of each launch file should be enclosed between these tags.

#### Launching nodes

The heart of any launch file is a collection of node elements, each of
which names a single [node](http://wiki.ros.org/roslaunch/XML/node) to launch. A node element looks like this:

```
<node
pkg="package-name"
type="executable-name"
name="node-name"
/>
```

>⚠️ The trailing slash near the end of the node tag is both important and easy to forget.
> It indicates that no closing tag (“`</node>`”) is coming, and that the node element
> is complete. XML parsers are required to be very strict about this sort of thing. If
> you omit this slash, be prepared for errors like this:
>```
> Invalid roslaunch XML syntax: mismatched tag
> ```
> You can also also write the closing tag explicitly:
> ```
> node pkg="..." type="..." name="..."></node>
> ```
> In fact, this explicit closing tag is needed if the node has children, such as `remap` or
> `param` elements. These elements are introduced in Section 6.4 and 7.4, respectively
{: .fs-3 .code-example }

A `node` element has three required attributes:

- The `pkg` and `type` attributes identify which program ROS should run to start this
node. These are the same as the two command line arguments to `rosrun`, specifying
the package name and the executable name, respectively.
- The `name` attribute assigns a name to the node. This overrides any name that the
node would normally assign to itself in its call to `ros::init`.

> ⏩This override fully clobbers the naming information provided to `ros::init`, 
> including any request that the node might have made for an anonymous name.
> (See Section 5.4.) To use an anonymous name from within a [launch](http://wiki.ros.org/roslaunch/XML) file, use
> an `anon` substitution for the name attribute, like this:
> ```
> name="$(anon base_name)"
> ```
> Note, however, that multiple uses of the same base name will generate the
> same anonymous name. This means that (a) we can refer to that name in
> other parts of the launch file, but (b) we must be careful to use different base
> names for each node we want to anonymize.
{: .fs-3 .code-example }

#### Finding node log files

An important difference between `roslaunch` and running each
node individually using `rosrun` is that, by default, standard output from launched nodes is
redirected to a log file, and does not appear on the console<sup>[1](#fn1)</sup>. The name of this log file is:

```
∼/.ros/log/run_id/node_name-number-stdout.log
```

The `run_id` is a unique identifier generated when the master is started. (See page 72 for
details about how to look up the current `run_id`.) The numbers in these file names are
small integers that number the nodes. For example, running the launch file in Listing 6.1
sends the standard output of two of its nodes to log files with these names:

```
turtlesim-1-stdout.log
telep_key-3-stdout.log
```

These log files can be viewed with the text editor of your choice.

#### Directing output to the console 
To override this behavior for a single node, use the `output` attribute in its `node` element:

```
output="screen"
```

Nodes launched with this attribute will display their standard output on screen instead
of in the log files discussed above. The example uses this attribute for the `subpose` node,
which explains why the `INFO` messages from this node appear on the console. It also
explains why this node is missing from the list of log files above.

In addition to the `output` attribute, which affects only a single node, we can also force
roslaunch to display output from all of its nodes, using the `--screen` command-line option:

```
roslaunch --screen package-name launch-file-name
```

>⚠️ If a program, when started from roslaunch, does not appear to be producing the
>output you expect, you should verify that that node has the `output="screen"` attribute set.
{: .fs-3 .code-example }

#### Requesting respawning 
After starting all of the requested nodes, `roslaunch` monitors
each node, keeping track of which ones remain active. For each node, we can ask `roslaunch` to restart it when it terminates, by using a `respawn` attribute:

```
respawn="true"
```

This can be useful, for example, for nodes that might terminate prematurely, due to software crashes, hardware problems, or other reasons.

The respawn attribute is not really necessary in our example—All three programs are
quite reliable—but we include it for the `turtlesim_node` to illustrate how respawning
works. If you close the `turtlesim` window, the corresponding node will terminate. ROS
quickly notices this and, since that node is marked as a `respawn` node, a new `turtlesim`
node, with its accompanying window, appears to replace the previous one.

#### Requiring nodes 

An alternative to `respawn` is to declare that a node is `required`:

```
required="true"
```

When a `required` node terminates, `roslaunch` responds by terminating all of the other active nodes and exiting itself. 
That sort of behavior might be useful, for example, for nodes
that (a) are so important that, if they fail, the entire session should be abandoned, and (b)
cannot be gracefully restarted by the `respawn` attribute.

The example uses the required attribute for the `turtle_teleop_key` node. If you close
the window in which the teleoperation node runs, roslaunch will kill the other two nodes
and exit.

>⚠️ Because their meanings conflict with one another, `roslaunch` will complain if you
> set both the `respawn` and `required` attributes for a single node
{: .fs-3 .code-example }


____
<a name="fn1">1</a> In the current version of `roslaunch`, output on standard error—notably including console outputs of
`ERROR-` and `FATAL-level` log messages—appears on the console, rather than in log files. However, a comment in the `roslaunch`
source code notes that this behavior may be changed in the future.
